# üì§ 2. Endpoint Crear/Actualizar Clientes

Este endpoint permite a un **cliente de tipo Reseller** registrar nuevos clientes en el sistema o **actualizar los datos** de clientes ya existentes asociados a su cuenta.

La operaci√≥n es **idempotente**: si el RUC ya existe y pertenece al reseller, los datos enviados **sobrescribir√°n** los existentes. En caso contrario, se considerar√° una **alta de nuevo cliente**.

> üí° **Importante**: Este endpoint solo est√° disponible para usuarios marcados como **cliente tipo Reseller**. Si un usuario sin este privilegio intenta usarlo, recibir√° un error de autorizaci√≥n.

---

## üõ†Ô∏è Credenciales Autom√°ticas Generadas

Por cada cliente nuevo creado, el sistema generar√° autom√°ticamente dos tipos de usuarios:

### üîê Usuario API

|     Campo      |           Formato         |      Ejemplo      |
|----------------|---------------------------|-------------------|
|  **Usuario**   |       RUC del cliente     |   `12345678901`   |
| **Contrase√±a** | `Contrase√±a Autogenerada` | `S6a8Es0+qfceSKM` |

### üåê Usuario Web

|     Campo      |            Formato            |     Ejemplo      |
|----------------|-------------------------------|------------------|
|   **Usuario**  | RUC del cliente + A√±o actual  | `123456789012024`|
| **Contrase√±a** |   `Contrase√±a Autogenerada`   | `GLQX?!2Ys7q4jvS`|

> üîí **Nota**: Tanto el **usuario** como **contrase√±a** Web pueden ser modificadas posteriormente desde el sistema, si el cliente lo requiere.

---

## üåç URLs del Endpoint

| Entorno     | URL                                                            | M√©todo |
|:-----------:|:--------------------------------------------------------------:|:------:|
| Producci√≥n  | `https://api.sendfact.com/resellers/clients/batch`|  POST  |
| Demo        | `https://demo-api.sendfact.com/resellers/clients/batch` |  POST  |

---

## üì§ Par√°metros de Env√≠o

| Par√°metro               | Tipo     | Descripci√≥n T√©cnica                                                                 |
|-------------------------|----------|--------------------------------------------------------------------------------------|
| `ruc`                   | string   | N√∫mero de RUC del cliente. Se usa como identificador √∫nico. Si ya existe, se actualiza. |
| `company_name`          | string   | Nombre o raz√≥n social de la empresa.                                                |
| `email`                 | string   | Correo electr√≥nico de la empresa. Requerido si desea recibir comprobantes por email. |
| `phone_number`          | string   | Tel√©fono fijo de contacto de la empresa.                                            |
| `mobile_number`         | string   | N√∫mero de celular de la empresa.                                                    |
| `validator_entity`      | int      | Identificador de la entidad validadora de comprobantes:                              |
|                         |          | `0`: SUNAT  |
|                         |          | `1`: OSE GIOR (Recomendado)         |
|                         |          | `2`: OSE EFACT        |
|                         |          | `3`: OSE NUBEFACT     |
| `external_ose_username` | string   | Usuario OSE externo (obligatorio si se usa Efact o Nubefact como entidad validadora). |
| `external_ose_password` | string   | Contrase√±a del usuario OSE externo.                                                 |
| `is_ose_validation_only`| boolean  | Si es `true`, solo se utilizar√° el servicio OSE GIOR. Si es `false`, se usar√° el servicio PSE GIOR (solo aplica cuando `validator_entity = 1`). |
| `integration_type`      | int      | Formato de integraci√≥n del cliente: `0` para XML, `1` para JSON.                    |

---

## üßæ Ejemplo de Solicitud

```json
[
  {
    "ruc": "20713128381",
    "company_name": "A&J CORPORTATION S.A.C",
    "email": "correocorporativo@gmail.com",
    "phone_number": "711-0550",
    "mobile_number": "162984123",
    "validator_entity": 0,
    "external_ose_username": null,
    "external_ose_password": null,
    "is_ose_validation_only": null,
    "integration_type": 1
  }
]
```

###  **Respuestas Esperadas:**

####  **Creaci√≥n Cliente :**
> ‚úÖ **HTTP Response 200 OK**
```json
{
    "created_clients": [
        {
            "ruc": "20713128381",
            "company_name": "A&J CORPORTATION S.A.C",
            "access_api": {
                "username": "20713128381",
                "password": "fxMTJ0-3#S19Fe_"
            },
            "access_web": {
                "username": "207131283812025",
                "password": "xB5CuhmbD=36Ts^"
            }
        }
    ],
    "updated_clients": []
}
```
#### ‚úÖ Respuesta (Alta de Cliente)

> Cuando se registra un nuevo cliente, la respuesta incluir√° las credenciales generadas autom√°ticamente para ambos accesos.

| Campo                  | Tipo     | Descripci√≥n                                                                         |
|------------------------|----------|-------------------------------------------------------------------------------------|
| `access_api`           | object   | Contenedor de credenciales para acceder a la API del sistema.                      |
| ‚îú‚îÄ `username`          | string   | Usuario API generado autom√°ticamente (formato: RUC).                               |
| ‚îî‚îÄ `password`          | string   | Contrase√±a API generada autom√°ticamente (formato: RUC@ApiPse).                     |
| `access_web`           | object   | Contenedor de credenciales para acceso al portal web.                              |
| ‚îú‚îÄ `username`          | string   | Usuario Web generado autom√°ticamente (formato: RUC + A√±o actual).                 |
| ‚îî‚îÄ `password`          | string   | Contrase√±a Web generada autom√°ticamente (formato: RUC@WebPse).                     |


####  **Actualizaci√≥n Cliente :**
> ‚úÖ **HTTP Response 200 OK**
```json
{
    "created_clients": [],
    "updated_clients": [
        {
            "ruc": "20713128381",
            "company_name": "A&J CORPORTATION S.A.C"
        }
    ]
}
```
---
#### üîÅ Respuesta (Modificaci√≥n de Cliente)

> Si el cliente ya exist√≠a, se actualizan los datos y se devuelve informaci√≥n b√°sica confirmando el cambio.

| Campo           | Tipo     | Descripci√≥n                                         |
|-----------------|----------|------------------------------------------------------|
| `ruc`           | string   | N√∫mero de RUC del cliente actualizado.              |
| `company_name`  | string   | Nuevo nombre o raz√≥n social del cliente, si fue modificado. |

